{"meta":{"title":"编程记","subtitle":"编程生活","description":"记录每次的编程代码","author":"区区小生","url":"https://vbee.club","root":"/"},"pages":[{"title":"404 Not Found：该页无法显示","date":"2020-03-11T12:45:47.421Z","updated":"2020-03-11T08:41:22.906Z","comments":false,"path":"/404.html","permalink":"https://vbee.club/404.html","excerpt":"","text":""},{"title":"关于","date":"2020-03-12T04:27:25.935Z","updated":"2020-03-12T04:27:25.935Z","comments":false,"path":"about/index.html","permalink":"https://vbee.club/about/index.html","excerpt":"","text":"我想大部分人都知道通常一个程序员会具有的美德。当然了，有三种：懒惰，暴躁，傲慢。1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253 .::::. .::::::::. ::::::::::: 既然来了就留下吧! ..:::::::::::' '::::::::::::' .:::::::::: '::::::::::::::.. ..::::::::::::. ``:::::::::::::::: ::::``:::::::::' .:::. ::::' ':::::' .::::::::. .::::' :::: .:::::::'::::. .:::' ::::: .:::::::::' ':::::. .::' :::::.:::::::::' ':::::. .::' ::::::::::::::' ``::::. ...::: ::::::::::::' ``::. ```` ':. ':::::::::' ::::.. '.:::::' ':'````.. 致终于来到这里的勇敢的人： 你是被上帝选中的人，是英勇的、不敌辛苦的、不眠不休的来修改我们这最棘手的代码的编程骑士。 你，我们的救世主，人中之龙，我要对你说：永远不要放弃，永远不要对自己失望，永远不要逃走，辜负了自己， 永远不要哭啼，永远不要说再见，永远不要说谎来伤害自己。==============================================================================================================================================================================================&#123; name: '区区小生' age: 26, gender: '男', profession: 'IE--&gt;IT', experience: '2年', address: '广东省江门市', education: '大专', blog: 'https://vbee.club/', email: '463550067@qq.com', description: '致力于分享VBA,VB6,VB.NET,B4A源码及互相交流.', skills: [ ['vba', 'Javascript', 'vb6', 'vb.net', 'b4a', 'php'], ['python', 'html','MYSQL'], ], devTools: [ ['Sublime Text', 'Visual Studio Code', 'Notepad++'], ['Chrome DevTools', 'Fiddler'], ['VS 2019', 'Navicat'], ] &#125;"},{"title":"书单","date":"2020-03-11T11:18:40.183Z","updated":"2020-03-11T08:41:22.907Z","comments":false,"path":"books/index.html","permalink":"https://vbee.club/books/index.html","excerpt":"","text":""},{"title":"友情链接","date":"2020-03-11T10:17:46.300Z","updated":"2020-03-11T08:41:22.908Z","comments":true,"path":"links/index.html","permalink":"https://vbee.club/links/index.html","excerpt":"","text":""},{"title":"标签","date":"2020-03-11T13:59:48.943Z","updated":"2020-03-11T13:59:48.943Z","comments":false,"path":"tags/index.html","permalink":"https://vbee.club/tags/index.html","excerpt":"","text":""},{"title":"分类","date":"2020-03-11T10:17:39.173Z","updated":"2020-03-11T08:57:52.823Z","comments":false,"path":"categories/index.html","permalink":"https://vbee.club/categories/index.html","excerpt":"","text":""},{"title":"GitHub项目","date":"2020-03-11T11:47:44.255Z","updated":"2020-03-11T11:47:44.255Z","comments":false,"path":"repository/index.html","permalink":"https://vbee.club/repository/index.html","excerpt":"","text":""}],"posts":[{"title":"B4A 检测是否使用 VPN","slug":"B4A_CHEAK_TF_VPN","date":"2020-03-12T02:26:03.000Z","updated":"2020-03-12T02:26:03.000Z","comments":true,"path":"2020/03/12/B4A_CHEAK_TF_VPN/","link":"","permalink":"https://vbee.club/2020/03/12/B4A_CHEAK_TF_VPN/","excerpt":"","text":"提权1AddPermission(android.permission.ACCESS_NETWORK_STATE) 源码12345678910111213141516171819202122232425Sub tf_vpn() As Boolean Try Dim p As Phone,tf As Boolean=False If p.SdkVersion &gt;= 21 Then Dim jobj As JavaObject jobj.InitializeContext Dim manager As JavaObject = jobj.RunMethod(\"getSystemService\", Array(\"connectivity\")) Dim networks() As Object = manager.RunMethod(\"getAllNetworks\", Null) For Each network As JavaObject In networks Dim capabilities As JavaObject = manager.RunMethod(\"getNetworkCapabilities\", Array(network)) Dim IsVPN As Boolean = capabilities.RunMethod(\"hasTransport\", Array(4)) 'TRANSPORT_VPN If IsVPN Then tf= True Next If tf Then Return True Else Return False End If Else Return False End If Catch Return False End TryEnd Sub","categories":[{"name":"B4A","slug":"B4A","permalink":"https://vbee.club/categories/B4A/"}],"tags":[{"name":"B4A","slug":"B4A","permalink":"https://vbee.club/tags/B4A/"},{"name":"VPN","slug":"VPN","permalink":"https://vbee.club/tags/VPN/"}]},{"title":"B4A 关闭严格模式","slug":"B4A_close_ygms","date":"2020-03-12T02:26:03.000Z","updated":"2020-03-12T02:26:03.000Z","comments":true,"path":"2020/03/12/B4A_close_ygms/","link":"","permalink":"https://vbee.club/2020/03/12/B4A_close_ygms/","excerpt":"","text":"12345678910111213Sub DisableStrictMode '关闭严格模式 Dim jo As JavaObject jo.InitializeStatic(\"android.os.Build.VERSION\") If jo.GetField(\"SDK_INT\") &gt; 9 Then Dim policy As JavaObject policy = policy.InitializeNewInstance(\"android.os.StrictMode.ThreadPolicy.Builder\", Null) policy = policy.RunMethodJO(\"permitAll\", Null).RunMethodJO(\"build\", Null) Dim sm As JavaObject sm.InitializeStatic(\"android.os.StrictMode\").RunMethod(\"setThreadPolicy\", Array(policy)) End IfEnd Sub","categories":[{"name":"B4A","slug":"B4A","permalink":"https://vbee.club/categories/B4A/"}],"tags":[{"name":"B4A","slug":"B4A","permalink":"https://vbee.club/tags/B4A/"}]},{"title":"B4A 粘贴板使用方法","slug":"B4A_clp_use_eg","date":"2020-03-12T02:26:03.000Z","updated":"2020-03-12T02:26:03.000Z","comments":true,"path":"2020/03/12/B4A_clp_use_eg/","link":"","permalink":"https://vbee.club/2020/03/12/B4A_clp_use_eg/","excerpt":"","text":"12345Dim clb As BClipboard,dystr As String''必须先检测has否则程序崩溃If clb.HasText Then dystr = clb.getTextEnd If","categories":[{"name":"B4A","slug":"B4A","permalink":"https://vbee.club/categories/B4A/"}],"tags":[{"name":"B4A","slug":"B4A","permalink":"https://vbee.club/tags/B4A/"}]},{"title":"CMD 获取本地wifi密码","slug":"CMD_GET_WIFI_PASS","date":"2020-03-12T02:26:03.000Z","updated":"2020-03-12T02:26:03.000Z","comments":true,"path":"2020/03/12/CMD_GET_WIFI_PASS/","link":"","permalink":"https://vbee.club/2020/03/12/CMD_GET_WIFI_PASS/","excerpt":"","text":"123获取wifi网络列表: netsh.exe wlan show profile获取指定wifi名的信息包括密码: netsh.exe wlan show profile wifi名称 key=clear","categories":[{"name":"CMD","slug":"CMD","permalink":"https://vbee.club/categories/CMD/"}],"tags":[{"name":"wifi","slug":"wifi","permalink":"https://vbee.club/tags/wifi/"},{"name":"CMD","slug":"CMD","permalink":"https://vbee.club/tags/CMD/"}]},{"title":"php base64转图片","slug":"php_base64toamages","date":"2020-03-12T02:26:03.000Z","updated":"2020-03-12T02:26:03.000Z","comments":true,"path":"2020/03/12/php_base64toamages/","link":"","permalink":"https://vbee.club/2020/03/12/php_base64toamages/","excerpt":"","text":"12345678910111213141516171819202122232425262728293031323334353637383940public function upload2()&#123; $pid = $_SESSION['cmpid']; $model='communication'; $categpry='img'; if (preg_match('/^(data:\\s*image\\/(\\w+);base64,)/', $this-&gt;post-&gt;file, $result)) &#123; $ramd = $this-&gt;loadModel('businesscard')-&gt;random(6, 0); $type = $result[2]; $new_file ='slidimg/'.time() . $ramd . '.' . $type;// $new_file = \"./test.&#123;$type&#125;\"; if (file_put_contents($new_file, base64_decode(str_replace($result[1], '', $this-&gt;post-&gt;file)))) &#123;// $ym = date('Ym', time());// $upload_path = $this-&gt;app-&gt;getAppRoot() . \"www/data/upload/\" . $model . '/' . $categpry . '/' . $ym . \"/\"; //上传文件的存放路径// //开始移动文件到相应的文件夹// if (!file_exists($upload_path)) &#123;// mkdir($upload_path, 0777, true);//创建目录// &#125;// if (copy('/module/communication/1512122578eT7Vin.jpeg','/www/data/upload/communication/img/201712/s.jpeg')) &#123;// echo \"ok\";// &#125; else &#123;// echo 'false';// &#125; $this-&gt;dao-&gt;insert(TABLE_CSLIDERIMG) -&gt;set('url')-&gt;eq('module/communication/'.$new_file) -&gt;set('create_time')-&gt;eq(helper::now(time())) -&gt;set('cpid')-&gt;eq($pid) -&gt;exec(); echo '新文件保存成功：', $new_file; &#125; &#125;// echo 'xxx----' . $a;// $pid = ‘123124afeewrt234’;// $upload=$this-&gt;communication-&gt;uploadimg($pid);// echo $upload; &#125;","categories":[{"name":"php","slug":"php","permalink":"https://vbee.club/categories/php/"}],"tags":[{"name":"base64","slug":"base64","permalink":"https://vbee.club/tags/base64/"}]},{"title":"php url分片下载大文件","slug":"php_curl_fd_download","date":"2020-03-12T02:26:03.000Z","updated":"2020-03-12T02:26:03.000Z","comments":true,"path":"2020/03/12/php_curl_fd_download/","link":"","permalink":"https://vbee.club/2020/03/12/php_curl_fd_download/","excerpt":"","text":"123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129url分片下载大文件//get请求获取body体function curl_get_with_body($url, $range)&#123; $curl = curl_init(); curl_setopt_array($curl, array( CURLOPT_URL =&gt; $url, CURLOPT_RETURNTRANSFER =&gt; true, CURLOPT_ENCODING =&gt; \"\", CURLOPT_MAXREDIRS =&gt; 10, CURLOPT_TIMEOUT =&gt; 30, CURLOPT_HTTP_VERSION =&gt; CURL_HTTP_VERSION_1_1, CURLOPT_CUSTOMREQUEST =&gt; \"GET\", CURLOPT_POSTFIELDS =&gt; \"\", CURLOPT_SSL_VERIFYPEER =&gt; false, CURLOPT_SSL_VERIFYHOST =&gt; 2, CURLOPT_HTTPHEADER =&gt; array( \"Range: bytes=&#123;$range&#125;\" ), )); $response = curl_exec($curl); $err = curl_error($curl); curl_close($curl); if ($err) &#123; return \"cURL Error #:\" . $err; &#125; else &#123; return $response; &#125;&#125;//get请求function curl_get_with_head($url, $header)&#123; $curl = curl_init(); curl_setopt_array($curl, array( CURLOPT_URL =&gt; $url, CURLOPT_RETURNTRANSFER =&gt; true, CURLOPT_ENCODING =&gt; \"\", CURLOPT_MAXREDIRS =&gt; 10, CURLOPT_TIMEOUT =&gt; 30, CURLOPT_HTTP_VERSION =&gt; CURL_HTTP_VERSION_1_1, CURLOPT_CUSTOMREQUEST =&gt; \"HEAD\", CURLOPT_POSTFIELDS =&gt; \"\", CURLOPT_SSL_VERIFYPEER =&gt; false, CURLOPT_SSL_VERIFYHOST =&gt; 2, //CURLINFO_HEADER_OUT =&gt; TRUE, //获取请求头 CURLOPT_HEADER =&gt; true, //获取响应头 CURLOPT_NOBODY =&gt; true, //不需要响应正文 CURLOPT_HTTPHEADER =&gt; $header, )); $response = curl_exec($curl); $err = curl_error($curl); curl_close($curl); $responseHeader = explode(\"\\r\\n\", $response); $totalLength = $eTag = ''; foreach($responseHeader as $response) &#123; if($response)&#123; //获取文件总长度 if(strpos($response, 'Content-Range:', 0) !== false) &#123; $totalLength = explode(':', $response); $totalLength = array_pop($totalLength); $totalLength = explode('/', $totalLength); $totalLength = array_pop($totalLength); &#125; //获取文件etag if(strpos($response, 'ETag:', 0) !== false) &#123; $eTag = explode(':', $response); $eTag = array_pop($eTag); $eTag = trim(str_replace('\"', '', $eTag)); &#125; &#125; &#125; if ($err) &#123; return \"cURL Error #:\" . $err; &#125; else &#123; return ['length' =&gt; $totalLength, 'etag' =&gt; $eTag]; &#125;&#125;function download_file($file_url,$file_path,$rname,$ext)&#123;// $file = \"http://public.geek-in.net/clouddisk/NYsrTpPRjz.mp4\"; $range = \"0-1\"; $response = curl_get_with_head($file_url, array( \"Range: bytes=&#123;$range&#125;\" )); $eTag = $response['etag']; $length = $response['length']; if(file_exists($file_path.$rname.'.'.$ext)) &#123; if (filesize($file_path . $rname . '.' . $ext) != $length) &#123;//大小不一样重新下载 try &#123; unlink($file_path . $rname . '.' . $ext); &#125;catch (Exception $exception)&#123; echo \"删除文件失败：&#123;$file_path&#125;&#123;$rname&#125;.&#123;$ext&#125;\" . PHP_EOL; &#125; $chunkCount = 100; $chunkCount = $length/10000000; $step = ceil($length / $chunkCount); echo 11111; $fp=fopen(\"&#123;$file_path&#125;&#123;$rname&#125;.&#123;$ext&#125;\", 'w+'); for($i=0;$i&lt;$chunkCount;$i++) &#123; $start = $i * $step; $end = (($i+1) * $step) -1; if($end &gt; $length) &#123; $end = $length; &#125; $range = $start. '-'. $end; $con = curl_get_with_body($file_url, $range);// file_put_contents(\"&#123;$file_path&#125;&#123;$rname&#125;.&#123;$ext&#125;\", $con, FILE_APPEND); fwrite($fp, $con); echo(\"总大小&#123;$length&#125;,共计&#123;$chunkCount&#125;片，第&#123;$i&#125;片下载完成, range:\". $range .PHP_EOL); &#125; echo \"下载完成，总大小：&#123;$length&#125;,\"; fclose($fp); &#125; &#125;&#125;download_file(\"http://www.www.ss.mp4\",\"D:\\\",\"cc\",\"mp4\")","categories":[{"name":"php","slug":"php","permalink":"https://vbee.club/categories/php/"}],"tags":[{"name":"download","slug":"download","permalink":"https://vbee.club/tags/download/"}]},{"title":"php utf8去除Bom头","slug":"php_clear_utf8_bom","date":"2020-03-12T02:26:03.000Z","updated":"2020-03-12T02:26:03.000Z","comments":true,"path":"2020/03/12/php_clear_utf8_bom/","link":"","permalink":"https://vbee.club/2020/03/12/php_clear_utf8_bom/","excerpt":"","text":"1234567891011121314去除Bom头 /** * 去掉UTF-8 Bom头。 * Remove UTF-8 Bom. * * @param string $string * @access public * @return string */ public static function removeUTF8Bom($string) &#123; if(substr($string, 0, 3) == pack('CCC', 239, 187, 191)) return substr($string, 3); return $string; &#125;","categories":[{"name":"php","slug":"php","permalink":"https://vbee.club/categories/php/"}],"tags":[{"name":"utf8","slug":"utf8","permalink":"https://vbee.club/tags/utf8/"}]},{"title":"php 裁剪图片","slug":"php_cut_image","date":"2020-03-12T02:26:03.000Z","updated":"2020-03-12T02:26:03.000Z","comments":true,"path":"2020/03/12/php_cut_image/","link":"","permalink":"https://vbee.club/2020/03/12/php_cut_image/","excerpt":"","text":"12345678910111213141516171819202122232425262728293031323334353637裁剪图片public function upload3() &#123; $pid = $_SESSION['cmpid']; $allow_type = array('jpg', 'jpeg', 'gif', 'png'); //定义允许上传的类型 $file = $this-&gt;loadModel('businesscard')-&gt;file($_FILES['file'], $allow_type, 'communication', 'img'); $ramd = $this-&gt;loadModel('businesscard')-&gt;random(6, 0); $filename=time() . $ramd; if ($file) &#123; $left = $this-&gt;post-&gt;left; $width = $this-&gt;post-&gt;width; $height = $this-&gt;post-&gt;height; $top = $this-&gt;post-&gt;top; $image = '../../' . $file; $source = imagecreatefromjpeg($image); $croped = imagecreatetruecolor($width, $height); imagecopy($croped, $source, 0, 0, $left, $top, $width, $height); imagejpeg($croped, \"$filename.jpg\"); imagedestroy($croped); unlink('../../' . $file); $fielPath=preg_split('/\\//', $file); if (copy(\"$filename.jpg\", \"../../$fielPath[0]/$fielPath[1]/$fielPath[2]/$fielPath[3]/$fielPath[4]/$fielPath[5]/$filename.jpg\")) &#123; unlink(\"$filename.jpg\"); $this-&gt;dao-&gt;insert(TABLE_CSLIDERIMG) -&gt;set('url')-&gt;eq(\"$fielPath[0]/$fielPath[1]/$fielPath[2]/$fielPath[3]/$fielPath[4]/$fielPath[5]/$filename.jpg\") -&gt;set('create_time')-&gt;eq(helper::now(time())) -&gt;set('cpid')-&gt;eq($pid) -&gt;exec(); echo 1; &#125; else &#123; echo 0; &#125; &#125; else &#123; echo 0; &#125; &#125;","categories":[{"name":"php","slug":"php","permalink":"https://vbee.club/categories/php/"}],"tags":[{"name":"image","slug":"image","permalink":"https://vbee.club/tags/image/"}]},{"title":"php 下载远程图片到本地","slug":"php_download_image","date":"2020-03-12T02:26:03.000Z","updated":"2020-03-12T02:26:03.000Z","comments":true,"path":"2020/03/12/php_download_image/","link":"","permalink":"https://vbee.club/2020/03/12/php_download_image/","excerpt":"","text":"1234567891011121314151617181920212223242526272829303132333435363738394041424344下载远程图片到本地/** * 下载远程图片保存到本地 * @access public * @return array * @params string $url 远程图片地址 * @params string $save_dir 需要保存的地址 * @params string $filename 保存文件名 */function download($url, $save_dir = './publicimgs/',$filename='')&#123; if(trim($save_dir)=='') $save_dir='./'; if(trim($filename)=='')&#123;//保存文件名 $allowExt = array('gif', 'jpg', 'jpeg', 'png', 'bmp'); $ext=strrchr($url,'.'); if(!in_array($ext,$allowExt)) return array('file_name'=&gt;'','save_path'=&gt;'','error'=&gt;3); $filename=time().$ext; &#125; if(0!==strrpos($save_dir,'/')) $save_dir.='/'; //创建保存目录 if(!file_exists($save_dir)&amp;&amp;!mkdir($save_dir,0777,true)) return array('file_name'=&gt;'','save_path'=&gt;'','error'=&gt;5); $ch = curl_init(); curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, false); // 信任任何证书 curl_setopt($ch, CURLOPT_URL, $url); curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1); curl_setopt($ch, CURLOPT_CONNECTTIMEOUT, 30); $file = curl_exec($ch); curl_close($ch); $resource = fopen($save_dir . $filename, 'a'); fwrite($resource, $file); fclose($resource); unset($file,$url); return array('file_name'=&gt;$filename,'save_path'=&gt;$save_dir.$filename,'error'=&gt;0);&#125;","categories":[{"name":"php","slug":"php","permalink":"https://vbee.club/categories/php/"}],"tags":[{"name":"download","slug":"download","permalink":"https://vbee.club/tags/download/"}]},{"title":"php 文件下载","slug":"php_download_file","date":"2020-03-12T02:26:03.000Z","updated":"2020-03-12T02:26:03.000Z","comments":true,"path":"2020/03/12/php_download_file/","link":"","permalink":"https://vbee.club/2020/03/12/php_download_file/","excerpt":"","text":"123456文件下载$fileName = ROOT_PATH.'/public/export/d58c42391a0cc5419a34c2a5eca19409abc904af954e0327561cbd1cee18ee20.html'; //得到文件名 header( \"Content-Disposition: attachment; filename=\".$fileName); //告诉浏览器通过附件形式来处理文件 header('Content-Length: ' . filesize($fileName)); //下载文件大小 readfile($fileName); //读取文件内容","categories":[{"name":"php","slug":"php","permalink":"https://vbee.club/categories/php/"}],"tags":[{"name":"download","slug":"download","permalink":"https://vbee.club/tags/download/"}]},{"title":"php excel导入导出","slug":"php_excel_in_output","date":"2020-03-12T02:26:03.000Z","updated":"2020-03-12T02:26:03.000Z","comments":true,"path":"2020/03/12/php_excel_in_output/","link":"","permalink":"https://vbee.club/2020/03/12/php_excel_in_output/","excerpt":"","text":"12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152excel导出 include_once '../../../lib/phpexcel/phpexcel.class.php'; $objPHPExcel = new \\PHPExcel(); $objWriter =new \\PHPExcel_Writer_Excel2007($objPHPExcel);$objPHPExcel-&gt;createSheet(); $objPHPExcel-&gt;setactivesheetindex(5); $objPHPExcel-&gt;getActiveSheet(5)-&gt;setCellValue('A1', '项目'); $objPHPExcel-&gt;getActiveSheet(5)-&gt;setCellValue('B1', '修复成功'); $objPHPExcel-&gt;getActiveSheet(5)-&gt;setCellValue('C1', '修复失败'); $objPHPExcel-&gt;getActiveSheet(5)-&gt;setTitle('汇总'); $objPHPExcel-&gt;getActiveSheet(5)-&gt;setCellValue('A2', '荔湾移动4G'); $objPHPExcel-&gt;getActiveSheet(5)-&gt;setCellValue('B2', $repair_data-&gt;yd4gs); $objPHPExcel-&gt;getActiveSheet(5)-&gt;setCellValue('C2', $repair_data-&gt;yd4gf); //导出 $path='../../../www/data/excelexport'; $filename = time() . '.xls'; $objWriter-&gt;save(\"$path/$filename\"); $name = $filename; $fileName = $path.'/' . $name; //得到文件名 header(\"Content-Disposition: attachment; filename=\" . $fileName); //告诉浏览器通过附件形式来处理文件 header('Content-Length: ' . filesize($fileName)); //下载文件大小 readfile($fileName); //读取文件内容excel导入 include_once '../../../lib/phpexcel/phpexcel.class.php'; $file = $_FILES['file']; if ($file['error'] == 4) $this-&gt;error('请选择上传excel文件'); $file_types = explode ( \".\", $file['name'] ); $excel_type = array('xls','csv','xlsx'); if (!in_array(strtolower(end($file_types)),$excel_type))&#123; $this-&gt;error(\"不是Excel文件，请重新上传\"); &#125; //哪一行开始是实际数据 $start_index=2; //设置获取excel对象 $objReader = \\PHPExcel_IOFactory::createReader('Excel2007');//配置成2003版本，因为office版本可以向下兼容 $objPHPExcel = $objReader-&gt;load($file['tmp_name'],$encode='utf-8');//$file 为解读的excel文件 $sheet = $objPHPExcel-&gt;getSheet(0); $highestRow = $sheet-&gt;getHighestRow()+$start_index; // 取得总行数 $success_item = $fail_item = 0; for($j=$start_index;$j&lt;=$highestRow;$j++) &#123; $mt_number = $objPHPExcel-&gt;getActiveSheet()-&gt;getCell(\"G\".$j)-&gt;getValue();//平台监控点编号&#125;Response::success('成功条数:'.$success_item.'，失败条数：'.$fail_item);","categories":[{"name":"php","slug":"php","permalink":"https://vbee.club/categories/php/"}],"tags":[{"name":"excel","slug":"excel","permalink":"https://vbee.club/tags/excel/"}]},{"title":"php 下载视频","slug":"php_download_video","date":"2020-03-12T02:26:03.000Z","updated":"2020-03-12T02:26:03.000Z","comments":true,"path":"2020/03/12/php_download_video/","link":"","permalink":"https://vbee.club/2020/03/12/php_download_video/","excerpt":"","text":"12345678910111213141516171819202122232425下载视频function downVideo($url,$filePath)&#123;//初始化 $curl = curl_init();//设置抓取的url curl_setopt($curl, CURLOPT_URL, $url);//打开文件描述符 $fp = fopen ($filePath, 'w+'); curl_setopt($curl, CURLOPT_FILE, $fp);//这个选项是意思是跳转，如果你访问的页面跳转到另一个页面，也会模拟访问。 curl_setopt($curl, CURLOPT_FOLLOWLOCATION, true); curl_setopt($curl,CURLOPT_TIMEOUT,50);//执行命令 curl_exec($curl);//关闭URL请求 curl_close($curl);//关闭文件描述符 fclose($fp);&#125;downVideo(\"http://public.geek-in.net/clouddisk/bSCrjZKXyR.mp4\", $root_dir . 'cs.mp4');","categories":[{"name":"php","slug":"php","permalink":"https://vbee.club/categories/php/"}],"tags":[{"name":"video","slug":"video","permalink":"https://vbee.club/tags/video/"}]},{"title":"php 获取区域网IP地址","slug":"php_get_ad_ip","date":"2020-03-12T02:26:03.000Z","updated":"2020-03-12T02:26:03.000Z","comments":true,"path":"2020/03/12/php_get_ad_ip/","link":"","permalink":"https://vbee.club/2020/03/12/php_get_ad_ip/","excerpt":"","text":"1234获取区域网IP地址 $host_name = exec(\"hostname\"); $host_ip = gethostbyname($host_name); //获取本机的局域网IP echo $host_ip;","categories":[{"name":"php","slug":"php","permalink":"https://vbee.club/categories/php/"}],"tags":[{"name":"network","slug":"network","permalink":"https://vbee.club/tags/network/"}]},{"title":"php 百度地图经纬度转腾讯地图经纬度","slug":"php_get_jwd","date":"2020-03-12T02:26:03.000Z","updated":"2020-03-12T02:26:03.000Z","comments":true,"path":"2020/03/12/php_get_jwd/","link":"","permalink":"https://vbee.club/2020/03/12/php_get_jwd/","excerpt":"","text":"123456789101112131415161718192021百度地图经纬度转腾讯地图经纬度/** * 百度地图经纬度转腾讯地图经纬度 * @param $lat * @param $lon * @return string */ public function map_bd2tx($lat, $lon) &#123; $tx_lat = 0; $tx_lon = 0; $x_pi = 3.14159265358979324; $x = $lon - 0.0065; $y = $lat - 0.006;//Math $z = sqrt($x * $x + $y * $y) - 0.00002 * sin($y * $x_pi); $theta = atan2($y, $x) - 0.000003 * cos($x * $x_pi); $tx_lon = $z * cos($theta); $tx_lat = $z * sin($theta); return $tx_lat . \",\" . $tx_lon; &#125;","categories":[{"name":"php","slug":"php","permalink":"https://vbee.club/categories/php/"}],"tags":[{"name":"map","slug":"map","permalink":"https://vbee.club/tags/map/"}]},{"title":"php 获取近1年的所有月份","slug":"php_get_year","date":"2020-03-12T02:26:03.000Z","updated":"2020-03-12T02:26:03.000Z","comments":true,"path":"2020/03/12/php_get_year/","link":"","permalink":"https://vbee.club/2020/03/12/php_get_year/","excerpt":"","text":"12345678910111213获取近1年的所有月份 $z = date('Y-m'); $a = date('Y-m', strtotime('-12 months')); $begin = new DateTime($a); $end = new DateTime($z); $end = $end-&gt;modify('+1 month'); $interval = new DateInterval('P1M'); $daterange = new DatePeriod($begin, $interval ,$end); foreach($daterange as $date)&#123; echo $date-&gt;format(\"Y-m\") . \"&lt;br /&gt;\"; &#125;","categories":[{"name":"php","slug":"php","permalink":"https://vbee.club/categories/php/"}],"tags":[{"name":"date","slug":"date","permalink":"https://vbee.club/tags/date/"}]},{"title":"php curl的get-post方式","slug":"php_get_post_curl","date":"2020-03-12T02:26:03.000Z","updated":"2020-03-12T02:26:03.000Z","comments":true,"path":"2020/03/12/php_get_post_curl/","link":"","permalink":"https://vbee.club/2020/03/12/php_get_post_curl/","excerpt":"","text":"123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566curl的get-post方式/** * post请求 * @param $url * @param $postdata * @return mixed */function get_component($url,$postdata)&#123; $ch = curl_init(); //用curl发送数据给api curl_setopt($ch,CURLOPT_HTTPHEADER,$header); curl_setopt( $ch, CURLOPT_POST, true ); curl_setopt( $ch, CURLOPT_RETURNTRANSFER, true ); curl_setopt( $ch, CURLOPT_URL, $url ); curl_setopt( $ch, CURLOPT_POSTFIELDS, $postdata ); curl_setopt( $ch, CURLOPT_SSL_VERIFYPEER, FALSE ); curl_setopt( $ch, CURLOPT_SSL_VERIFYHOST, FALSE ); $response = curl_exec($ch); curl_close( $ch ); $rest = json_decode($response,true); return $rest;&#125;/** * post请求 row形式 * @param $url * @param $postdata * @return mixed */function post_row($url,$post_data)&#123;$ch = curl_init(); curl_setopt($ch, CURLOPT_POST, 1); curl_setopt($ch, CURLOPT_URL, $url); curl_setopt($ch, CURLOPT_POSTFIELDS, $post_data); curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1); curl_setopt($ch, CURLOPT_HTTPHEADER, array( 'Content-Type: application/json; charset=utf-8', 'Content-Length: ' . strlen($post_data) ) ); $response = curl_exec($ch); $httpCode = curl_getinfo($ch, CURLINFO_HTTP_CODE); curl_close($ch); return $response;&#125;/** * get请求 * @param $url * @return mixed */function curlget($url)&#123; $ch = curl_init(); curl_setopt($ch, CURLOPT_URL, $url); curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1); curl_setopt($ch, CURLOPT_HEADER, 0); curl_setopt( $ch, CURLOPT_SSL_VERIFYPEER, FALSE ); curl_setopt( $ch, CURLOPT_SSL_VERIFYHOST, FALSE ); $response = curl_exec($ch); curl_close( $ch ); $rest = json_decode($response,true); return $rest;&#125;","categories":[{"name":"php","slug":"php","permalink":"https://vbee.club/categories/php/"}],"tags":[{"name":"curl","slug":"curl","permalink":"https://vbee.club/tags/curl/"}]},{"title":"php 判断ip是否在允许范围内","slug":"php_ip_fw","date":"2020-03-12T02:26:03.000Z","updated":"2020-03-12T02:26:03.000Z","comments":true,"path":"2020/03/12/php_ip_fw/","link":"","permalink":"https://vbee.club/2020/03/12/php_ip_fw/","excerpt":"","text":"12345678910111213141516171819202122232425262728判断ip是否在允许范围内/** * 检查ip是否在允许范围 * @param $host_ip * @return bool */ private function checkIP($host_ip)&#123; $alip = '192.1.*.*'; $start_ip = $alip; foreach ($alip as $ind=&gt;$item) &#123; if($item=='*')&#123; $alip[$ind]=255; $start_ip[$ind] = 1; &#125; &#125; $end_id = implode('.', $alip); $start_ip = implode('.', $start_ip); $host_ip = bindec(decbin(ip2long($host_ip))); $start_ip=bindec(decbin(ip2long($start_ip))); $end_id=bindec(decbin(ip2long($end_id))); if($start_ip&lt;=$host_ip&amp;&amp;$host_ip&lt;=$end_id)&#123; return true; &#125;else&#123; return false; &#125; &#125;","categories":[{"name":"php","slug":"php","permalink":"https://vbee.club/categories/php/"}],"tags":[{"name":"network","slug":"network","permalink":"https://vbee.club/tags/network/"}]},{"title":"php Hmac加密","slug":"php_hmac_pass","date":"2020-03-12T02:26:03.000Z","updated":"2020-03-12T02:26:03.000Z","comments":true,"path":"2020/03/12/php_hmac_pass/","link":"","permalink":"https://vbee.club/2020/03/12/php_hmac_pass/","excerpt":"","text":"123456Hmac加密private function computeSignature($accessSecret, $canonicalString) &#123; $s = hash_hmac('sha256', $canonicalString, $accessSecret, true); return base64_encode($s); &#125;","categories":[{"name":"php","slug":"php","permalink":"https://vbee.club/categories/php/"}],"tags":[{"name":"sha256","slug":"sha256","permalink":"https://vbee.club/tags/sha256/"}]},{"title":"php 图片合成","slug":"php_input_image","date":"2020-03-12T02:26:03.000Z","updated":"2020-03-12T02:26:03.000Z","comments":true,"path":"2020/03/12/php_input_image/","link":"","permalink":"https://vbee.club/2020/03/12/php_input_image/","excerpt":"","text":"123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657图片合成public function shareimg() &#123; $id = $_POST['uid'];//二维码图片 $qrodeimg = $this-&gt;getWxappQrCode($id);//背景图片 $bannerimg = ROOT_PATH . '/public/wxcode/back_one.png'; //这是需要插入到背景图的图片url// $qrodeimg = ROOT_PATH . '/public/wxcode/qrcode1.png'; //用户信息 //这是需要插入到背景图的图片url// $head_img = $user['head_img']; //这是要插入到图片的文字// $tip1 = \"长按小程序码可以查看我的名片，\";// $tip2 = \"即可领取红包！\";// $text = $user['nickname'] . \"发了一个口令红包\"; if ($bannerimg) &#123; //生成中间带logo的二维码 //这是合成后的图片保存的路径 $upload_dir = \"/public/wxcode/\"; if (is_file($bannerimg)) &#123; //创建画布 $logo = imagecreatefromstring(file_get_contents($bannerimg)); $head_img1 = imagecreatefromstring(file_get_contents($qrodeimg));// $head_img2 = imagecreatefromstring(file_get_contents($head_img)); //写入文字// $msg = imagecolorallocate($logo, 255, 225, 177);// $black = imagecolorallocate($logo, 255, 225, 177);// $grey = imagecolorallocate($logo, 255, 225, 177); //写的文字用到的字体// $font = ROOT_PATH . '/statics/font/black_font.ttf'; //将$qrodeimg插入到$bannerimg里 imagecopyresampled($logo, $head_img1, 80, 80, 0, 0, 200, 200, imagesx($head_img1), imagesy($head_img1)); //将$head_img插入到$bannerimg里// imagecopyresampled($logo, $head_img2, 400, 30, 0, 0, 100, 100, imagesx($head_img2), imagesy($head_img2)); //在图片里插入文字($msg,$black,$grey)// imagettftext($logo, 24, 0, 280, 180, $msg,$font, $text);// imagettftext($logo, 30, 0, 170, 280, $black,$font, $tip1);// imagettftext($logo, 30, 0, 330, 340, $grey, $font, $tip2); $rans = rand(100,900).time().'code'.'.png'; //生成图片 imagepng($logo, ROOT_PATH . $upload_dir . $rans); //生成图片名字// $twocode = $upload_dir . '97243655qrcode' . '.png'; //如果存在logo就生成带logo的 $twocode = $rans; //如果存在logo就生成带logo的 &#125; //返回结果图片url throw new Success(['data' =&gt; 'http://'.$_SERVER['HTTP_HOST'].'/wxcode/'.$twocode]); &#125; else &#123; return false; &#125; &#125;","categories":[{"name":"php","slug":"php","permalink":"https://vbee.club/categories/php/"}],"tags":[{"name":"image","slug":"image","permalink":"https://vbee.club/tags/image/"}]},{"title":"php常用方法","slug":"php_nol_meth","date":"2020-03-12T02:26:03.000Z","updated":"2020-03-12T02:26:03.000Z","comments":true,"path":"2020/03/12/php_nol_meth/","link":"","permalink":"https://vbee.club/2020/03/12/php_nol_meth/","excerpt":"","text":"12345678910111213141516171819202122232425262728//判断某个字符是否在数组内bool in_array ($needle,$array [,strict])//例子：//分割字符串preg_split();//例子： $str='1,2,3,4';preg_split('/,/',$str);//求数组交集，并集，差集array_diff()//差集array_merge ( array array1[,array… ] ) //并集array_intersect ( array array1,arrayarray2 [, array $ … ] ) //交集//数组的插入，头部，尾部，中部//头部array_unshift(array $array,$val)//头部插入array_shift()//头部移除array_push(array $array,$val)//插入尾部array_pop()////数组去除重复值array_unique()//一维数组转为字符串implode//字符串转为数组explode","categories":[{"name":"php","slug":"php","permalink":"https://vbee.club/categories/php/"}],"tags":[{"name":"php","slug":"php","permalink":"https://vbee.club/tags/php/"}]},{"title":"php 图片缩放","slug":"php_sc_image","date":"2020-03-12T02:26:03.000Z","updated":"2020-03-12T02:26:03.000Z","comments":true,"path":"2020/03/12/php_sc_image/","link":"","permalink":"https://vbee.club/2020/03/12/php_sc_image/","excerpt":"","text":"1234567891011121314151617181920212223242526图片缩放/** * 缩放图片 * @param $filename 图片地址 * @param $per 缩放倍数 1.2 0.3 * @return string */ private function scaleImg($filename,$per)&#123; $per_str=implode('_', explode('.', $per)); $new_file_name=__DIR__.'/xxx_scale_'.$per_str.'.png'; //如果图片大小大于1 if (getimagesize($filename) &gt; 1) &#123; list($width, $height) = getimagesize($filename); $n_w = $width * $per; $n_h = $height * $per; $new = imagecreatetruecolor($n_w, $n_h); $img = imagecreatefromstring(file_get_contents($filename)); //copy部分图像并调整 imagecopyresized($new, $img, 0, 0, 0, 0, $n_w, $n_h, $width, $height); //图像输出新图片、另存为 imagepng($new, $new_file_name); imagedestroy($new); imagedestroy($img); &#125; return $new_file_name;","categories":[{"name":"php","slug":"php","permalink":"https://vbee.club/categories/php/"}],"tags":[{"name":"iamge","slug":"iamge","permalink":"https://vbee.club/tags/iamge/"}]},{"title":"php post请求json中文字符被转码","slug":"php_json_ccode","date":"2020-03-12T02:26:03.000Z","updated":"2020-03-12T02:26:03.000Z","comments":true,"path":"2020/03/12/php_json_ccode/","link":"","permalink":"https://vbee.club/2020/03/12/php_json_ccode/","excerpt":"","text":"123post请求json中文字符被转码//强制不转码json_encode($json,JSON_UNESCAPED_UNICODE)","categories":[{"name":"php","slug":"php","permalink":"https://vbee.club/categories/php/"}],"tags":[{"name":"json","slug":"json","permalink":"https://vbee.club/tags/json/"}]},{"title":"php 解析url地址获得参数","slug":"php_jx_parm","date":"2020-03-12T02:26:03.000Z","updated":"2020-03-12T02:26:03.000Z","comments":true,"path":"2020/03/12/php_jx_parm/","link":"","permalink":"https://vbee.club/2020/03/12/php_jx_parm/","excerpt":"","text":"1234567891011121314151617181920解析url地址获得参数$link='http://www.baidu.com?article_id=123'; //app内链接 返回article_id 和article_anew_id function convertUrlQuery($query) &#123; $queryParts = explode('&amp;', $query); $params = array(); foreach ($queryParts as $param) &#123; $item = explode('=', $param); $params[$item[0]] = $item[1]; &#125; return $params; &#125; $arr =parse_url($link); $q=convertUrlQuery($arr['query']); $article_id = $q['article_id'] ?? 0;","categories":[{"name":"php","slug":"php","permalink":"https://vbee.club/categories/php/"}],"tags":[{"name":"url","slug":"url","permalink":"https://vbee.club/tags/url/"}]},{"title":"php mcurl_get请求和post请求","slug":"php_post_get_mcurl","date":"2020-03-12T02:26:03.000Z","updated":"2020-03-12T02:26:03.000Z","comments":true,"path":"2020/03/12/php_post_get_mcurl/","link":"","permalink":"https://vbee.club/2020/03/12/php_post_get_mcurl/","excerpt":"","text":"123456789101112131415161718192021222324252627282930313233get请求function mcurl_get($url) &#123; $curl = curl_init(); curl_setopt($curl, CURLOPT_URL, $url); curl_setopt($curl, CURLOPT_RETURNTRANSFER, true); curl_setopt($curl, CURLOPT_BINARYTRANSFER, true); curl_setopt($curl, CURLINFO_HEADER_OUT, FALSE); curl_setopt($curl, CURLOPT_SSL_VERIFYPEER, FALSE); curl_setopt($curl, CURLOPT_SSL_VERIFYHOST, FALSE); $data = curl_exec($curl); curl_close($curl); return $data; &#125;post请求function mcurl_post($url,$post_data)&#123;$ch = curl_init();curl_setopt($ch, CURLOPT_URL, $url);curl_setopt($ch, CURLOPT_POSTFIELDS, 'mypost=' . $post_data);curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);curl_setopt($ch, CURLOPT_USERAGENT, \"jb51.net's CURL Example beta\");$data = curl_exec($ch);curl_close($ch);return $data;&#125;","categories":[{"name":"php","slug":"php","permalink":"https://vbee.club/categories/php/"}],"tags":[{"name":"network","slug":"network","permalink":"https://vbee.club/tags/network/"}]},{"title":"php 判断时间","slug":"php_tf_time","date":"2020-03-12T02:26:03.000Z","updated":"2020-03-12T02:26:03.000Z","comments":true,"path":"2020/03/12/php_tf_time/","link":"","permalink":"https://vbee.club/2020/03/12/php_tf_time/","excerpt":"","text":"12345判断时间if(date('Y-m-d')==date('Y-m-d', strtotime($res[0]-&gt;createtime)))&#123; $finance_day_num+=1; $finance_day_money+=$res[0]-&gt;payamount; &#125;","categories":[{"name":"php","slug":"php","permalink":"https://vbee.club/categories/php/"}],"tags":[{"name":"date","slug":"date","permalink":"https://vbee.club/tags/date/"}]},{"title":"php 设置脚本运行时间","slug":"php_set_scipt_run_time","date":"2020-03-12T02:26:03.000Z","updated":"2020-03-12T02:26:03.000Z","comments":true,"path":"2020/03/12/php_set_scipt_run_time/","link":"","permalink":"https://vbee.club/2020/03/12/php_set_scipt_run_time/","excerpt":"","text":"12设置脚本运行时间ini_set('max_execution_time', '0');//永久","categories":[{"name":"php","slug":"php","permalink":"https://vbee.club/categories/php/"}],"tags":[{"name":"脚本","slug":"脚本","permalink":"https://vbee.club/tags/%E8%84%9A%E6%9C%AC/"}]},{"title":"php 判断是否手机浏览器","slug":"php_tf_moblie_ua","date":"2020-03-12T02:26:03.000Z","updated":"2020-03-12T02:26:03.000Z","comments":true,"path":"2020/03/12/php_tf_moblie_ua/","link":"","permalink":"https://vbee.club/2020/03/12/php_tf_moblie_ua/","excerpt":"","text":"12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364判断是否手机浏览器 //判断是否是微信浏览器 function isWeixin() &#123; if (strpos($_SERVER['HTTP_USER_AGENT'], 'MicroMessenger') !== false) &#123; return true; &#125; else &#123; return false; &#125; &#125; //判断是否是手机浏览器 function isMobile() &#123; // 如果有HTTP_X_WAP_PROFILE则一定是移动设备 if (isset($_SERVER['HTTP_X_WAP_PROFILE'])) &#123; return true; &#125; // 如果via信息含有wap则一定是移动设备,部分服务商会屏蔽该信息 if (isset($_SERVER['HTTP_VIA'])) &#123; // 找不到为flase,否则为true return stristr($_SERVER['HTTP_VIA'], \"wap\") ? true : false; &#125; // 脑残法，判断手机发送的客户端标志,兼容性有待提高。其中'MicroMessenger'是电脑微信 if (isset($_SERVER['HTTP_USER_AGENT'])) &#123; $clientkeywords = array('nokia','sony','ericsson','mot','samsung','htc','sgh','lg','sharp','sie-','philips','panasonic','alcatel','lenovo','iphone','ipod','blackberry','meizu','android','netfront','symbian','ucweb','windowsce','palm','operamini','operamobi','openwave','nexusone','cldc','midp','wap','mobile','MicroMessenger'); // 从HTTP_USER_AGENT中查找手机浏览器的关键字 if (preg_match(\"/(\" . implode('|', $clientkeywords) . \")/i\", strtolower($_SERVER['HTTP_USER_AGENT']))) &#123; return true; &#125; &#125; // 协议法，因为有可能不准确，放到最后判断 if (isset ($_SERVER['HTTP_ACCEPT'])) &#123; // 如果只支持wml并且不支持html那一定是移动设备 // 如果支持wml和html但是wml在html之前则是移动设备 if ((strpos($_SERVER['HTTP_ACCEPT'], 'vnd.wap.wml') !== false) &amp;&amp; (strpos($_SERVER['HTTP_ACCEPT'], 'text/html') === false || (strpos($_SERVER['HTTP_ACCEPT'], 'vnd.wap.wml') &lt; strpos($_SERVER['HTTP_ACCEPT'], 'text/html')))) &#123; return true; &#125; &#125;// return true; return false; &#125; function isMobile2()&#123; $useragent=isset($_SERVER['HTTP_USER_AGENT']) ? $_SERVER['HTTP_USER_AGENT'] : ''; $useragent_commentsblock=preg_match('||',$useragent,$matches)&gt;0?$matches[0]:''; function CheckSubstrs($substrs,$text)&#123; foreach($substrs as $substr)&#123; if(false!==strpos($text,$substr))&#123; return true; &#125;else&#123; return false; &#125; &#125; &#125; $mobile_os_list=array('Google Wireless Transcoder','Windows CE','WindowsCE','Symbian','Android','armv6l','armv5','Mobile','CentOS','mowser','AvantGo','Opera Mobi','J2ME/MIDP','Smartphone','Go.Web','Palm','iPAQ'); $mobile_token_list=array('Profile/MIDP','Configuration/CLDC-','160×160','176×220','240×240','240×320','320×240','UP.Browser','UP.Link','SymbianOS','PalmOS','PocketPC','SonyEricsson','Nokia','BlackBerry','Vodafone','BenQ','Novarra-Vision','Iris','NetFront','HTC_','Xda_','SAMSUNG-SGH','Wapaka','DoCoMo','iPhone','iPod'); $found_mobile=CheckSubstrs($mobile_os_list,$useragent_commentsblock) || CheckSubstrs($mobile_token_list,$useragent); if ($found_mobile)&#123; return true; &#125;else&#123; return false; &#125; &#125;","categories":[{"name":"php","slug":"php","permalink":"https://vbee.club/categories/php/"}],"tags":[{"name":"UA","slug":"UA","permalink":"https://vbee.club/tags/UA/"}]},{"title":"php 获取两个时间戳的相差天数，小时，分钟，秒","slug":"php_time_sjc","date":"2020-03-12T02:26:03.000Z","updated":"2020-03-12T02:26:03.000Z","comments":true,"path":"2020/03/12/php_time_sjc/","link":"","permalink":"https://vbee.club/2020/03/12/php_time_sjc/","excerpt":"","text":"12345678910111213141516171819202122232425262728293031获取两个时间戳的相差天数，小时，分钟，秒/** * 计算两个时间戳之间相差的日时分秒 * @param $begin_time 开始时间戳 * @param $end_time 结束时间戳 * @return array */ function timediff($begin_time,$end_time) &#123; if($begin_time &lt; $end_time)&#123; $starttime = $begin_time; $endtime = $end_time; &#125;else&#123; $starttime = $end_time; $endtime = $begin_time; &#125;//计算天数 $timediff = $endtime-$starttime; $days = intval($timediff/86400);//计算小时数 $remain = $timediff%86400; $hours = intval($remain/3600);//计算分钟数 $remain = $remain%3600; $mins = intval($remain/60);//计算秒数 $secs = $remain%60; $res = array(\"day\" =&gt; $days,\"hour\" =&gt; $hours,\"min\" =&gt; $mins,\"sec\" =&gt; $secs); return $res; &#125;","categories":[{"name":"php","slug":"php","permalink":"https://vbee.club/categories/php/"}],"tags":[{"name":"date","slug":"date","permalink":"https://vbee.club/tags/date/"}]},{"title":"php 判断时间是否在某个区域内","slug":"php_tf_time_dq","date":"2020-03-12T02:26:03.000Z","updated":"2020-03-12T02:26:03.000Z","comments":true,"path":"2020/03/12/php_tf_time_dq/","link":"","permalink":"https://vbee.club/2020/03/12/php_tf_time_dq/","excerpt":"","text":"1234567891011121314151617181920判断时间是否在某个区域内function get_curr_time_section() &#123; $checkDayStr = date('Y-m-d ',time()); $timeBegin1 = strtotime($checkDayStr.\"09:00\".\":00\"); $timeEnd1 = strtotime($checkDayStr.\"18:00\".\":00\"); $curr_time = time(); if($curr_time &gt;= $timeBegin1 &amp;&amp; $curr_time &lt;= $timeEnd1) &#123; return 0; &#125; return -1; &#125; $result = get_curr_time_section(); echo $result;","categories":[{"name":"php","slug":"php","permalink":"https://vbee.club/categories/php/"}],"tags":[{"name":"date","slug":"date","permalink":"https://vbee.club/tags/date/"}]},{"title":"php 生成验证码","slug":"php_yzm_image","date":"2020-03-12T02:26:03.000Z","updated":"2020-03-12T02:26:03.000Z","comments":true,"path":"2020/03/12/php_yzm_image/","link":"","permalink":"https://vbee.club/2020/03/12/php_yzm_image/","excerpt":"","text":"12345678910111213141516171819202122232425262728293031323334353637383940414243生成验证码 /** * 验证码 */ public function getCode($num = \"4\", $w = \"80\", $h = \"26\") &#123; $str = Array(); //用来存储随机码 $vcode = \"\"; $string = \"ABCDEFGHIJKLMNPQRSTUVWXYZabcdefghjklpiuytrewq123456789\";//随机挑选其中4个字符，也可以选择更多，注意循环的时候加上，宽度适当调整 for ($i = 0; $i &lt; $num; $i++) &#123; $str[$i] = $string[rand(0, 35)]; $vcode .= $str[$i]; &#125; $this-&gt;set('verification', $vcode, 300); $im = imagecreatetruecolor($w, $h); $white = imagecolorallocate($im, 255, 255, 255); //第一次调用设置背景色 $black = imagecolorallocate($im, 0, 0, 0); //边框颜色 imagefilledrectangle($im, 0, 0, $w, $h, $white); //画一矩形填充 imagerectangle($im, 0, 0, $w - 1, $h - 1, $black); //画一矩形框//生成雪花背景 for ($i = 1; $i &lt; 200; $i++) &#123; $x = mt_rand(1, $w - 9); $y = mt_rand(1, $h - 9); $color = imagecolorallocate($im, mt_rand(200, 255), mt_rand(200, 255), mt_rand(200, 255)); imagechar($im, 1, $x, $y, \"*\", $color); &#125;//将验证码写入图案 for ($i = 0; $i &lt; count($str); $i++) &#123; $x = 13 + $i * ($w - 15) / 4; $y = mt_rand(3, $h / 3); $color = imagecolorallocate($im, mt_rand(0, 225), mt_rand(0, 150), mt_rand(0, 225)); imagechar($im, 5, $x, $y, $str[$i], $color); &#125; ob_clean();//原来的程序没有这一栏 header(\"Content-type:image/jpeg\"); //以jpeg格式输出，注意上面不能输出任何字符，否则出错 imagejpeg($im); imagedestroy($im); &#125;","categories":[{"name":"php","slug":"php","permalink":"https://vbee.club/categories/php/"}],"tags":[{"name":"image","slug":"image","permalink":"https://vbee.club/tags/image/"}]},{"title":"php 多图上传保存","slug":"php_upload_image","date":"2020-03-12T02:26:03.000Z","updated":"2020-03-12T02:26:03.000Z","comments":true,"path":"2020/03/12/php_upload_image/","link":"","permalink":"https://vbee.club/2020/03/12/php_upload_image/","excerpt":"","text":"1234567891011121314151617181920212223242526272829多图上传保存public function moreimgupload() &#123; $htmlfilename = 'files'; $new_folder='../../../www/data/upload/'; $allow_ext = array('jpg', 'jpeg', 'png', 'gif'); $data = array(); for ($i=0;$i&lt;count($_FILES[$htmlfilename]['tmp_name']);$i++) &#123;// 创建文件夹 $floder = $new_folder . date('Ym'); if(!is_dir($floder))&#123; mkdir($floder); &#125; $ext=explode('/', $_FILES[$htmlfilename]['type'][$i]); $end_ext=$ext[1];//后缀 if(!in_array(strtolower($end_ext),$allow_ext))&#123; Response::success('','上传文件不在允许范围'); &#125; $filenam = '/web' . time() . '.' . $end_ext;//保存文件名字 $upfile=$floder.$filenam;//此处路径换成你的 if(move_uploaded_file($_FILES[$htmlfilename]['tmp_name'][$i],$upfile))&#123; $data[] = 'www/data/upload/'.date('Ym').$filenam; &#125; &#125; Response::success($data); &#125;","categories":[{"name":"php","slug":"php","permalink":"https://vbee.club/categories/php/"}],"tags":[{"name":"image","slug":"image","permalink":"https://vbee.club/tags/image/"}]},{"title":"php 中奖概率换算","slug":"php_zj_hs","date":"2020-03-12T02:26:03.000Z","updated":"2020-03-12T02:26:03.000Z","comments":true,"path":"2020/03/12/php_zj_hs/","link":"","permalink":"https://vbee.club/2020/03/12/php_zj_hs/","excerpt":"","text":"1234567891011121314151617181920212223242526272829303132333435363738中奖概率换算$proArr = array( array('id'=&gt;1,'name'=&gt;'特等奖','v'=&gt;1), array('id'=&gt;2,'name'=&gt;'一等奖','v'=&gt;222), array('id'=&gt;3,'name'=&gt;'二等奖','v'=&gt;333), array('id'=&gt;4,'name'=&gt;'三等奖','v'=&gt;4444), array('id'=&gt;5,'name'=&gt;'谢谢惠顾','v'=&gt;9999) ); $res=$this-&gt;get_rand1($proArr);/** * 不同概率的抽奖原理就是把0到*（比重总数）的区间分块 * 分块的依据是物品占整个的比重，再根据随机数种子来产生0-* 中的某个数 * 判断这个数是落在哪个区间上，区间对应的就是抽到的那个物品。 * 随机数理论上是概率均等的，那么相应的区间所含数的多少就体现了抽奖物品概率的不同。 * @param $proArr * @return array */ function get_rand1($proArr) &#123; $result = array(); foreach ($proArr as $key =&gt; $val) &#123; $arr[$key] = $val['v']; &#125; // 概率数组的总概率 $proSum = array_sum($arr); asort($arr); // 概率数组循环 foreach ($arr as $k =&gt; $v) &#123; $randNum = mt_rand(1, $proSum); if ($randNum &lt;= $v) &#123; $result = $proArr[$k]; break; &#125; else &#123; $proSum -= $v; &#125; &#125; return $result; &#125;","categories":[{"name":"php","slug":"php","permalink":"https://vbee.club/categories/php/"}],"tags":[{"name":"抽奖","slug":"抽奖","permalink":"https://vbee.club/tags/%E6%8A%BD%E5%A5%96/"}]},{"title":"PYTHON 获取本机IP地址","slug":"python_get_loc_ip","date":"2020-03-12T02:26:03.000Z","updated":"2020-03-12T02:26:03.000Z","comments":true,"path":"2020/03/12/python_get_loc_ip/","link":"","permalink":"https://vbee.club/2020/03/12/python_get_loc_ip/","excerpt":"","text":"1234567891011import socket # 套字节,获取IP#获取本机IP##def get_host_ip(): ip=\"\" try: s = socket.socket(socket.AF_INET, socket.SOCK_DGRAM) s.connect(('8.8.8.8', 80)) ip = s.getsockname()[0] finally: s.close() return ip","categories":[{"name":"python","slug":"python","permalink":"https://vbee.club/categories/python/"}],"tags":[{"name":"python","slug":"python","permalink":"https://vbee.club/tags/python/"}]},{"title":"python MD5加密","slug":"python_MD5","date":"2020-03-12T02:26:03.000Z","updated":"2020-03-12T02:26:03.000Z","comments":true,"path":"2020/03/12/python_MD5/","link":"","permalink":"https://vbee.club/2020/03/12/python_MD5/","excerpt":"","text":"1234567891011import hashlibdef strtomd5(md5_str): try: m_str = hashlib.md5() byt = md5_str.encode(encoding='utf-8') m_str.update(byt) str_md5 = m_str.hexdigest() return str_md5 except: return None","categories":[{"name":"python","slug":"python","permalink":"https://vbee.club/categories/python/"}],"tags":[{"name":"MD5","slug":"MD5","permalink":"https://vbee.club/tags/MD5/"}]},{"title":"fastapi 示例","slug":"python_fastapi_eg","date":"2020-03-12T02:26:03.000Z","updated":"2020-03-12T02:26:03.000Z","comments":true,"path":"2020/03/12/python_fastapi_eg/","link":"","permalink":"https://vbee.club/2020/03/12/python_fastapi_eg/","excerpt":"","text":"123456789101112131415161718192021222324252627282930313233343536373839404142from fastapi import FastAPIfrom pydantic import BaseModelimport uvicornapp = FastAPI() #实例化FastAPIclass Item(BaseModel): name: str price: float is_offer: bool = None'''&#123; \"named\": \"string\", \"price\": 0, \"is_offer\": true&#125;'''@app.get(\"/\")async def read_root(): return &#123;\"Hello\": \"World\"&#125;@app.get(\"/items/&#123;item_id&#125;\")async def read_item(item_id: int, q: str = None): # 此处q为query的字段 return &#123;\"item_id\": item_id, \"q\": q&#125;@app.post(\"/items/&#123;item_id&#125;\")async def update_item(item_id: int, item: Item): # 此处Item为body的schema return &#123;\"item_name\": item.name, \"item_id\": item_id&#125;if __name__ == '__main__': uvicorn.run('main:app',port=8080)","categories":[{"name":"python","slug":"python","permalink":"https://vbee.club/categories/python/"}],"tags":[{"name":"fastapi","slug":"fastapi","permalink":"https://vbee.club/tags/fastapi/"}]},{"title":"python 之 platform 获取当前系统平台信息","slug":"python_platform_get_win_info","date":"2020-03-12T02:26:03.000Z","updated":"2020-03-12T02:26:03.000Z","comments":true,"path":"2020/03/12/python_platform_get_win_info/","link":"","permalink":"https://vbee.club/2020/03/12/python_platform_get_win_info/","excerpt":"","text":"下载地址:1pip install platformer -i https://pypi.douban.com/simple 源代码123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164#!/usr/bin/env python# -*- coding: UTF-8 -*-\"\"\"__author__='hzh'__time__= 2018/06/29\"\"\" import platform # global var# 是否显示日志信息SHOW_LOG=True def get_platform(): '''''获取操作系统名称及版本号''' return platform.platform() def get_version(): '''''获取操作系统版本号''' return platform.version() def get_architecture(): '''''获取操作系统的位数''' return platform.architecture() def get_machine(): '''''计算机类型''' return platform.machine() def get_node(): '''''计算机的网络名称''' return platform.node() def get_processor(): '''''计算机处理器信息''' return platform.processor() def get_system(): '''''获取操作系统类型''' return platform.system() def get_uname(): '''''汇总信息''' return platform.uname() def get_python_build(): ''''' the Python build number and date as strings''' return platform.python_build() def get_python_compiler(): '''''Returns a string identifying the compiler used for compiling Python''' return platform.python_compiler() def get_python_branch(): '''''Returns a string identifying the Python implementation SCM branch''' return platform.python_branch() def get_python_implementation(): '''''Returns a string identifying the Python implementation. Possible return values are: ‘CPython’, ‘IronPython’, ‘Jython’, ‘PyPy’.''' return platform.python_implementation() def get_python_version(): '''''Returns the Python version as string 'major.minor.patchlevel' ''' return platform.python_version() def get_python_revision(): '''''Returns a string identifying the Python implementation SCM revision.''' return platform.python_revision() def get_python_version_tuple(): '''''Returns the Python version as tuple (major, minor, patchlevel) of strings''' return platform.python_version_tuple() def show_os_all_info(): '''''打印os的全部信息''' print('获取操作系统名称及版本号 : [&#123;&#125;]'.format(get_platform())) print('获取操作系统版本号 : [&#123;&#125;]'.format(get_version())) print('获取操作系统的位数 : [&#123;&#125;]'.format(get_architecture())) print('计算机类型 : [&#123;&#125;]'.format(get_machine())) print('计算机的网络名称 : [&#123;&#125;]'.format(get_node())) print('计算机处理器信息 : [&#123;&#125;]'.format(get_processor())) print('获取操作系统类型 : [&#123;&#125;]'.format(get_system())) print('汇总信息 : [&#123;&#125;]'.format(get_uname())) def show_os_info(): '''''只打印os的信息，没有解释部分''' print(get_platform()) print(get_version()) print(get_architecture()) print(get_machine()) print(get_node()) print(get_processor()) print(get_system()) print(get_uname()) def show_python_all_info(): '''''打印python的全部信息''' print('The Python build number and date as strings : [&#123;&#125;]'.format(get_python_build())) print('Returns a string identifying the compiler used for compiling Python : [&#123;&#125;]'.format(get_python_compiler())) print('Returns a string identifying the Python implementation SCM branch : [&#123;&#125;]'.format(get_python_branch())) print('Returns a string identifying the Python implementation : [&#123;&#125;]'.format(get_python_implementation())) print('The version of Python ： [&#123;&#125;]'.format(get_python_version())) print('Python implementation SCM revision : [&#123;&#125;]'.format(get_python_revision())) print('Python version as tuple : [&#123;&#125;]'.format(get_python_version_tuple())) def show_python_info(): '''''只打印python的信息，没有解释部分''' print(get_python_build()) print(get_python_compiler()) print(get_python_branch()) print(get_python_implementation()) print(get_python_version()) print(get_python_revision()) print(get_python_version_tuple()) def test(): print('操作系统信息:') if SHOW_LOG: show_os_all_info() else: show_os_info() print('#' * 50) print('计算机中的python信息：') if SHOW_LOG: show_python_all_info() else: show_python_info() def init(): global SHOW_LOG SHOW_LOG=True def main(): init() test() if __name__ == '__main__': main()","categories":[{"name":"python","slug":"python","permalink":"https://vbee.club/categories/python/"}],"tags":[{"name":"python","slug":"python","permalink":"https://vbee.club/tags/python/"}]},{"title":"python mysql数据库 连接类","slug":"python_cn_mysql_cls","date":"2020-03-12T02:26:03.000Z","updated":"2020-03-12T02:26:03.000Z","comments":true,"path":"2020/03/12/python_cn_mysql_cls/","link":"","permalink":"https://vbee.club/2020/03/12/python_cn_mysql_cls/","excerpt":"","text":"123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596import pymysql#定义数据库连接类class MysqlHelper(object): #定义空连接 conn = None #初始化变量及类 def __init__(self, host, username, password, db, charset='utf8', port=3306): self.host = host #数据库地址 self.username = username #数据库用户名 self.password = password #数据库密码 self.db = db #数据库名称 self.charset = charset #数据库字符集 self.port = port #数据库端口 #连接数据库 def connect(self): #初始化数据库连接 self.conn = pymysql.connect(host=self.host, port=self.port, user=self.username, password=self.password, db=self.db,charset=self.charset) #初始化数据库游标 注意:这里返回的是字典对象,json self.cursor = self.conn.cursor(pymysql.cursors.DictCursor) #释放数据库 def close(self): #释放数据游标 self.cursor.close() #关闭数据库 self.conn.close() #获取数据库返回集中第一条记录 def get_one(self, sql, params=()): #定义空数据集 result = None try: if \"SELECT\" in str(sql).upper(): #检测是否为查询语句 self.connect() #连接数据库 self.cursor.execute(sql, params) #执行查询命令 result = self.cursor.fetchone() #返回第一条记录 self.close() #释放数据库 except Exception as e: print(e) return result #返回全部数据集合 def get_all(self, sql, params=()): #定义数据列表集合 list_data = () try: if \"SELECT\" in str(sql).upper(): #检测是否为查询语句 self.connect() #连接数据库 self.cursor.execute(sql, params) #执行查询命令 list_data = self.cursor.fetchall() #返回全部记录 self.close() #释放数据库 except Exception as e: print(e) return list_data #执行插入语句 def insert(self, sql, params=()): if \"INSERT\" in str(sql).upper(): #检测是否为插入语句 return self.__edit(sql, params) else: return None #执行数据库更新 def update(self, sql, params=()): if \"UPDATE\" in str(sql).upper(): #检测是否为更新语句 return self.__edit(sql, params) else: return None #执行数据删除 def delete(self, sql, params=()): if \"DELETE\" in str(sql).upper(): #检测是否为删除语句 return self.__edit(sql, params) else: return None #执行其他特殊命令 慎用 def cmdsql(self, sql, params=()): return self.__edit(sql, params) #执行命令函数 def __edit(self, sql, params): #定义影响行数 count = 0 try: self.connect() #连接数据库 count = self.cursor.execute(sql, params) #执行数据库命令语句 self.conn.commit() #把命令推送到服务器 self.close() #释放数据库 except Exception as e: print(e) return count #返回受影响的行数","categories":[{"name":"python","slug":"python","permalink":"https://vbee.club/categories/python/"}],"tags":[{"name":"python","slug":"python","permalink":"https://vbee.club/tags/python/"},{"name":"mysql","slug":"mysql","permalink":"https://vbee.club/tags/mysql/"}]},{"title":"B4A打开文件夹","slug":"B4A_open_fd","date":"2020-03-12T02:17:03.000Z","updated":"2020-03-12T02:17:03.000Z","comments":true,"path":"2020/03/12/B4A_open_fd/","link":"","permalink":"https://vbee.club/2020/03/12/B4A_open_fd/","excerpt":"","text":"123456789Try Dim i As Intent i.Initialize(i.ACTION_VIEW, \"file://\" &amp; File.DirRootExternal&amp;\"/保存目录/\" ) i.SetType( \"resource/folder\" ) StartActivity(i)Catch Msgbox(\"Missing default file explorer\", \"Error\")End Try","categories":[{"name":"B4A","slug":"B4A","permalink":"https://vbee.club/categories/B4A/"}],"tags":[{"name":"B4A","slug":"B4A","permalink":"https://vbee.club/tags/B4A/"}]},{"title":"VBA_MD5算法","slug":"VBA_MD5","date":"2020-03-11T14:03:03.000Z","updated":"2020-03-11T14:03:03.000Z","comments":true,"path":"2020/03/11/VBA_MD5/","link":"","permalink":"https://vbee.club/2020/03/11/VBA_MD5/","excerpt":"","text":"123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283284285286287288289290291292293294295296297298299300301302303304305306307308309310311312313314315316317318319320321322323324325326327328329330331332333334335336337338339340341342343344345346347348349350351352353354355356357358359360361362363364365366367368369370371372373Private Const BITS_TO_A_BYTE = 8Private Const BYTES_TO_A_WORD = 4Private Const BITS_TO_A_WORD = 32Private m_lOnBits(30)Private m_l2Power(30)Private Function LShift(lValue, iShiftBits) If iShiftBits = 0 Then LShift = lValue Exit Function ElseIf iShiftBits = 31 Then If lValue And 1 Then LShift = &amp;H80000000 Else LShift = 0 End If Exit Function ElseIf iShiftBits &lt; 0 Or iShiftBits &gt; 31 Then Err.Raise 6 End If If (lValue And m_l2Power(31 - iShiftBits)) Then LShift = ((lValue And m_lOnBits(31 - (iShiftBits + 1))) * m_l2Power(iShiftBits)) Or &amp;H80000000 Else LShift = ((lValue And m_lOnBits(31 - iShiftBits)) * m_l2Power(iShiftBits)) End IfEnd FunctionPrivate Function RShift(lValue, iShiftBits) If iShiftBits = 0 Then RShift = lValue Exit Function ElseIf iShiftBits = 31 Then If lValue And &amp;H80000000 Then RShift = 1 Else RShift = 0 End If Exit Function ElseIf iShiftBits &lt; 0 Or iShiftBits &gt; 31 Then Err.Raise 6 End If RShift = (lValue And &amp;H7FFFFFFE) \\ m_l2Power(iShiftBits) If (lValue And &amp;H80000000) Then RShift = (RShift Or (&amp;H40000000 \\ m_l2Power(iShiftBits - 1))) End IfEnd FunctionPrivate Function RotateLeft(lValue, iShiftBits) RotateLeft = LShift(lValue, iShiftBits) Or RShift(lValue, (32 - iShiftBits))End FunctionPrivate Function AddUnsigned(lX, lY) Dim lX4 Dim lY4 Dim lX8 Dim lY8 Dim lResult lX8 = lX And &amp;H80000000 lY8 = lY And &amp;H80000000 lX4 = lX And &amp;H40000000 lY4 = lY And &amp;H40000000 lResult = (lX And &amp;H3FFFFFFF) + (lY And &amp;H3FFFFFFF) If lX4 And lY4 Then lResult = lResult Xor &amp;H80000000 Xor lX8 Xor lY8 ElseIf lX4 Or lY4 Then If lResult And &amp;H40000000 Then lResult = lResult Xor &amp;HC0000000 Xor lX8 Xor lY8 Else lResult = lResult Xor &amp;H40000000 Xor lX8 Xor lY8 End If Else lResult = lResult Xor lX8 Xor lY8 End If AddUnsigned = lResultEnd FunctionPrivate Function md5_F(x, y, z) md5_F = (x And y) Or ((Not x) And z)End FunctionPrivate Function md5_G(x, y, z) md5_G = (x And z) Or (y And (Not z))End FunctionPrivate Function md5_H(x, y, z) md5_H = (x Xor y Xor z)End FunctionPrivate Function md5_I(x, y, z) md5_I = (y Xor (x Or (Not z)))End FunctionPrivate Sub md5_FF(a, b, c, d, x, s, ac) a = AddUnsigned(a, AddUnsigned(AddUnsigned(md5_F(b, c, d), x), ac)) a = RotateLeft(a, s) a = AddUnsigned(a, b)End SubPrivate Sub md5_GG(a, b, c, d, x, s, ac) a = AddUnsigned(a, AddUnsigned(AddUnsigned(md5_G(b, c, d), x), ac)) a = RotateLeft(a, s) a = AddUnsigned(a, b)End SubPrivate Sub md5_HH(a, b, c, d, x, s, ac) a = AddUnsigned(a, AddUnsigned(AddUnsigned(md5_H(b, c, d), x), ac)) a = RotateLeft(a, s) a = AddUnsigned(a, b)End SubPrivate Sub md5_II(a, b, c, d, x, s, ac) a = AddUnsigned(a, AddUnsigned(AddUnsigned(md5_I(b, c, d), x), ac)) a = RotateLeft(a, s) a = AddUnsigned(a, b)End SubPrivate Function ConvertToWordArray(sMessage) Dim lMessageLength Dim lNumberOfWords Dim lWordArray() Dim lBytePosition Dim lByteCount Dim lWordCount Const MODULUS_BITS = 512 Const CONGRUENT_BITS = 448 lMessageLength = Len(sMessage) lNumberOfWords = (((lMessageLength + ((MODULUS_BITS - CONGRUENT_BITS) \\ BITS_TO_A_BYTE)) \\ (MODULUS_BITS \\ BITS_TO_A_BYTE)) + 1) * (MODULUS_BITS \\ BITS_TO_A_WORD) ReDim lWordArray(lNumberOfWords - 1) lBytePosition = 0 lByteCount = 0 Do Until lByteCount &gt;= lMessageLength lWordCount = lByteCount \\ BYTES_TO_A_WORD lBytePosition = (lByteCount Mod BYTES_TO_A_WORD) * BITS_TO_A_BYTE lWordArray(lWordCount) = lWordArray(lWordCount) Or LShift(Asc(Mid(sMessage, lByteCount + 1, 1)), lBytePosition) lByteCount = lByteCount + 1 Loop lWordCount = lByteCount \\ BYTES_TO_A_WORD lBytePosition = (lByteCount Mod BYTES_TO_A_WORD) * BITS_TO_A_BYTE lWordArray(lWordCount) = lWordArray(lWordCount) Or LShift(&amp;H80, lBytePosition) lWordArray(lNumberOfWords - 2) = LShift(lMessageLength, 3) lWordArray(lNumberOfWords - 1) = RShift(lMessageLength, 29) ConvertToWordArray = lWordArrayEnd FunctionPrivate Function WordToHex(lValue) Dim lByte Dim lCount For lCount = 0 To 3 lByte = RShift(lValue, lCount * BITS_TO_A_BYTE) And m_lOnBits(BITS_TO_A_BYTE - 1) WordToHex = WordToHex &amp; Right(\"0\" &amp; Hex(lByte), 2) NextEnd FunctionPublic Function MD5(sMessage, stype) m_lOnBits(0) = CLng(1) m_lOnBits(1) = CLng(3) m_lOnBits(2) = CLng(7) m_lOnBits(3) = CLng(15) m_lOnBits(4) = CLng(31) m_lOnBits(5) = CLng(63) m_lOnBits(6) = CLng(127) m_lOnBits(7) = CLng(255) m_lOnBits(8) = CLng(511) m_lOnBits(9) = CLng(1023) m_lOnBits(10) = CLng(2047) m_lOnBits(11) = CLng(4095) m_lOnBits(12) = CLng(8191) m_lOnBits(13) = CLng(16383) m_lOnBits(14) = CLng(32767) m_lOnBits(15) = CLng(65535) m_lOnBits(16) = CLng(131071) m_lOnBits(17) = CLng(262143) m_lOnBits(18) = CLng(524287) m_lOnBits(19) = CLng(1048575) m_lOnBits(20) = CLng(2097151) m_lOnBits(21) = CLng(4194303) m_lOnBits(22) = CLng(8388607) m_lOnBits(23) = CLng(16777215) m_lOnBits(24) = CLng(33554431) m_lOnBits(25) = CLng(67108863) m_lOnBits(26) = CLng(134217727) m_lOnBits(27) = CLng(268435455) m_lOnBits(28) = CLng(536870911) m_lOnBits(29) = CLng(1073741823) m_lOnBits(30) = CLng(2147483647) m_l2Power(0) = CLng(1) m_l2Power(1) = CLng(2) m_l2Power(2) = CLng(4) m_l2Power(3) = CLng(8) m_l2Power(4) = CLng(16) m_l2Power(5) = CLng(32) m_l2Power(6) = CLng(64) m_l2Power(7) = CLng(128) m_l2Power(8) = CLng(256) m_l2Power(9) = CLng(512) m_l2Power(10) = CLng(1024) m_l2Power(11) = CLng(2048) m_l2Power(12) = CLng(4096) m_l2Power(13) = CLng(8192) m_l2Power(14) = CLng(16384) m_l2Power(15) = CLng(32768) m_l2Power(16) = CLng(65536) m_l2Power(17) = CLng(131072) m_l2Power(18) = CLng(262144) m_l2Power(19) = CLng(524288) m_l2Power(20) = CLng(1048576) m_l2Power(21) = CLng(2097152) m_l2Power(22) = CLng(4194304) m_l2Power(23) = CLng(8388608) m_l2Power(24) = CLng(16777216) m_l2Power(25) = CLng(33554432) m_l2Power(26) = CLng(67108864) m_l2Power(27) = CLng(134217728) m_l2Power(28) = CLng(268435456) m_l2Power(29) = CLng(536870912) m_l2Power(30) = CLng(1073741824) Dim x Dim k Dim AA Dim BB Dim CC Dim DD Dim a Dim b Dim c Dim d Const S11 = 7 Const S12 = 12 Const S13 = 17 Const S14 = 22 Const S21 = 5 Const S22 = 9 Const S23 = 14 Const S24 = 20 Const S31 = 4 Const S32 = 11 Const S33 = 16 Const S34 = 23 Const S41 = 6 Const S42 = 10 Const S43 = 15 Const S44 = 21 x = ConvertToWordArray(sMessage) a = &amp;H67452301 b = &amp;HEFCDAB89 c = &amp;H98BADCFE d = &amp;H10325476 For k = 0 To UBound(x) Step 16 AA = a BB = b CC = c DD = d md5_FF a, b, c, d, x(k + 0), S11, &amp;HD76AA478 md5_FF d, a, b, c, x(k + 1), S12, &amp;HE8C7B756 md5_FF c, d, a, b, x(k + 2), S13, &amp;H242070DB md5_FF b, c, d, a, x(k + 3), S14, &amp;HC1BDCEEE md5_FF a, b, c, d, x(k + 4), S11, &amp;HF57C0FAF md5_FF d, a, b, c, x(k + 5), S12, &amp;H4787C62A md5_FF c, d, a, b, x(k + 6), S13, &amp;HA8304613 md5_FF b, c, d, a, x(k + 7), S14, &amp;HFD469501 md5_FF a, b, c, d, x(k + 8), S11, &amp;H698098D8 md5_FF d, a, b, c, x(k + 9), S12, &amp;H8B44F7AF md5_FF c, d, a, b, x(k + 10), S13, &amp;HFFFF5BB1 md5_FF b, c, d, a, x(k + 11), S14, &amp;H895CD7BE md5_FF a, b, c, d, x(k + 12), S11, &amp;H6B901122 md5_FF d, a, b, c, x(k + 13), S12, &amp;HFD987193 md5_FF c, d, a, b, x(k + 14), S13, &amp;HA679438E md5_FF b, c, d, a, x(k + 15), S14, &amp;H49B40821 md5_GG a, b, c, d, x(k + 1), S21, &amp;HF61E2562 md5_GG d, a, b, c, x(k + 6), S22, &amp;HC040B340 md5_GG c, d, a, b, x(k + 11), S23, &amp;H265E5A51 md5_GG b, c, d, a, x(k + 0), S24, &amp;HE9B6C7AA md5_GG a, b, c, d, x(k + 5), S21, &amp;HD62F105D md5_GG d, a, b, c, x(k + 10), S22, &amp;H2441453 md5_GG c, d, a, b, x(k + 15), S23, &amp;HD8A1E681 md5_GG b, c, d, a, x(k + 4), S24, &amp;HE7D3FBC8 md5_GG a, b, c, d, x(k + 9), S21, &amp;H21E1CDE6 md5_GG d, a, b, c, x(k + 14), S22, &amp;HC33707D6 md5_GG c, d, a, b, x(k + 3), S23, &amp;HF4D50D87 md5_GG b, c, d, a, x(k + 8), S24, &amp;H455A14ED md5_GG a, b, c, d, x(k + 13), S21, &amp;HA9E3E905 md5_GG d, a, b, c, x(k + 2), S22, &amp;HFCEFA3F8 md5_GG c, d, a, b, x(k + 7), S23, &amp;H676F02D9 md5_GG b, c, d, a, x(k + 12), S24, &amp;H8D2A4C8A md5_HH a, b, c, d, x(k + 5), S31, &amp;HFFFA3942 md5_HH d, a, b, c, x(k + 8), S32, &amp;H8771F681 md5_HH c, d, a, b, x(k + 11), S33, &amp;H6D9D6122 md5_HH b, c, d, a, x(k + 14), S34, &amp;HFDE5380C md5_HH a, b, c, d, x(k + 1), S31, &amp;HA4BEEA44 md5_HH d, a, b, c, x(k + 4), S32, &amp;H4BDECFA9 md5_HH c, d, a, b, x(k + 7), S33, &amp;HF6BB4B60 md5_HH b, c, d, a, x(k + 10), S34, &amp;HBEBFBC70 md5_HH a, b, c, d, x(k + 13), S31, &amp;H289B7EC6 md5_HH d, a, b, c, x(k + 0), S32, &amp;HEAA127FA md5_HH c, d, a, b, x(k + 3), S33, &amp;HD4EF3085 md5_HH b, c, d, a, x(k + 6), S34, &amp;H4881D05 md5_HH a, b, c, d, x(k + 9), S31, &amp;HD9D4D039 md5_HH d, a, b, c, x(k + 12), S32, &amp;HE6DB99E5 md5_HH c, d, a, b, x(k + 15), S33, &amp;H1FA27CF8 md5_HH b, c, d, a, x(k + 2), S34, &amp;HC4AC5665 md5_II a, b, c, d, x(k + 0), S41, &amp;HF4292244 md5_II d, a, b, c, x(k + 7), S42, &amp;H432AFF97 md5_II c, d, a, b, x(k + 14), S43, &amp;HAB9423A7 md5_II b, c, d, a, x(k + 5), S44, &amp;HFC93A039 md5_II a, b, c, d, x(k + 12), S41, &amp;H655B59C3 md5_II d, a, b, c, x(k + 3), S42, &amp;H8F0CCC92 md5_II c, d, a, b, x(k + 10), S43, &amp;HFFEFF47D md5_II b, c, d, a, x(k + 1), S44, &amp;H85845DD1 md5_II a, b, c, d, x(k + 8), S41, &amp;H6FA87E4F md5_II d, a, b, c, x(k + 15), S42, &amp;HFE2CE6E0 md5_II c, d, a, b, x(k + 6), S43, &amp;HA3014314 md5_II b, c, d, a, x(k + 13), S44, &amp;H4E0811A1 md5_II a, b, c, d, x(k + 4), S41, &amp;HF7537E82 md5_II d, a, b, c, x(k + 11), S42, &amp;HBD3AF235 md5_II c, d, a, b, x(k + 2), S43, &amp;H2AD7D2BB md5_II b, c, d, a, x(k + 9), S44, &amp;HEB86D391 a = AddUnsigned(a, AA) b = AddUnsigned(b, BB) c = AddUnsigned(c, CC) d = AddUnsigned(d, DD) Next If stype = 32 Then MD5 = LCase(WordToHex(a) &amp; WordToHex(b) &amp; WordToHex(c) &amp; WordToHex(d)) Else MD5 = LCase(WordToHex(b) &amp; WordToHex(c)) End IfEnd Function'MD5是message-digest algorithm 5（信息-摘要算法）的缩写，被广泛用于加密和解密技术上，'它可以说是文件的\"数字指纹\"。任何一个文件，无论是可执行程序、图像文件、临时文件或者'其他任何类型的文件，也不管它体积多大，都有且只有一个独一无二的MD5信息值，并且如果这'个文件被修改过，它的MD5值也将随之改变。因此，我们可以通过对比同一文件的MD5值，来校验'这个文件是否被\"篡改\"过！''在各种登陆系统中，用户密码的md5加密是不可少的。这么说吧，即使你通过各种手段看到了用户'的登陆密码，但那一串古古怪怪的东西你也不可能知道它是什么，这就是保护。md5加密运算是不'可逆的，就是说你不能通过那一串古古怪怪的东西算出它原始的样子。下面是完整的md5代码，不'要去理解算法了，用到时拿去直接调用Sub test1() '只加密字符串 Debug.Print MD5(\"a\", 16) '16位加密 Debug.Print MD5(\"a\", 32) '32位加密End Sub","categories":[{"name":"VB","slug":"VB","permalink":"https://vbee.club/categories/VB/"}],"tags":[{"name":"VBA","slug":"VBA","permalink":"https://vbee.club/tags/VBA/"}]},{"title":"VBA_连接oracle数据库","slug":"VBA_con_oracel","date":"2020-03-11T14:03:03.000Z","updated":"2020-03-11T14:03:03.000Z","comments":true,"path":"2020/03/11/VBA_con_oracel/","link":"","permalink":"https://vbee.club/2020/03/11/VBA_con_oracel/","excerpt":"","text":"12345678910111213141516Public CNN As ADODB.ConnectionSub 连接数据库() Dim DataSource As String DataSource = Chr(34) &amp; \"(DESCRIPTION=(ADDRESS_LIST=(ADDRESS=(PROTOCOL=TCP)(HOST=111.111.111.111)(PORT=1521)))(CONNECT_DATA=(SERVICE_NAME=ser_name)))\" &amp; Chr(34) If CNN Is Nothing Then Set CNN = New ADODB.Connection With CNN .ConnectionString = \"Provider=MSDAORA.1; user id=userid; password=Password; data source = \" &amp; DataSource &amp; \"; Persist Security Info=True\" .Open End With Else If CNN.State &lt;&gt; 1 Then CNN.Open End If End IfEnd Sub","categories":[{"name":"VB","slug":"VB","permalink":"https://vbee.club/categories/VB/"}],"tags":[{"name":"VBA","slug":"VBA","permalink":"https://vbee.club/tags/VBA/"}]},{"title":"VBA_破解密码保护内容的excel表格","slug":"vba_clear_password","date":"2020-03-11T14:03:03.000Z","updated":"2020-03-11T14:03:03.000Z","comments":true,"path":"2020/03/11/vba_clear_password/","link":"","permalink":"https://vbee.club/2020/03/11/vba_clear_password/","excerpt":"","text":"123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211Sub Macro1() ' ' Breaks worksheet and workbook structure passwords. Jason S ' probably originator of base code algorithm modified for coverage ' of workbook structure / windows passwords and for multiple passwords ' Jason S http://jsbi.blogspot.com ' Reveals hashed passwords NOT original passwords Const DBLSPACE As String = vbNewLine &amp; vbNewLine Const AUTHORS As String = DBLSPACE &amp; vbNewLine &amp; \"Adapted from Bob McCormick base code by\" &amp; \"Jason S http://jsbi.blogspot.com\" Const HEADER As String = \"AllInternalPasswords User Message\" Const VERSION As String = DBLSPACE &amp; \"Version 1.0 8 Sep 2008\" Const REPBACK As String = DBLSPACE &amp; \"Please report failure to jasonblr@gmail.com \" Const ALLCLEAR As String = DBLSPACE &amp; \"The workbook should be cleared\" Const MSGNOPWORDS1 As String = \"There were no passwords on \" &amp; AUTHORS &amp; VERSION Const MSGNOPWORDS2 As String = \"There was no protection to \" &amp; \"workbook structure or windows.\" &amp; DBLSPACE Const MSGTAKETIME As String = \"After pressing OK button this \" &amp; \"will take some time.\" &amp; DBLSPACE &amp; \"Amount of time \" &amp; \"depends on how many different passwords, the \" Const MSGPWORDFOUND1 As String = \"You had a Worksheet \" &amp; \"Structure or Windows Password set.\" &amp; DBLSPACE &amp; \"The password found was: \" &amp; DBLSPACE &amp; \"$$\" &amp; DBLSPACE &amp; \"Note it down for potential future use in other workbooks by \" &amp; \"the same person who set this password.\" &amp; DBLSPACE &amp; \"Now to check and clear other passwords.\" &amp; AUTHORS &amp; VERSION Const MSGPWORDFOUND2 As String = \"You had a Worksheet \" &amp; \"password set.\" &amp; DBLSPACE &amp; \"The password found was: \" &amp; DBLSPACE &amp; \"$$\" &amp; DBLSPACE &amp; \"Note it down for potential \" &amp; \"future use in other workbooks by same person who \" &amp; \"set this password.\" &amp; DBLSPACE &amp; \"Now to check and clear \" &amp; \"other passwords.\" &amp; AUTHORS &amp; VERSION Const MSGONLYONE As String = \"Only structure / windows \" &amp; \"protected with the password that was just found.\" &amp; ALLCLEAR &amp; AUTHORS &amp; VERSION &amp; REPBACK Dim w1 As Worksheet, w2 As Worksheet Dim i As Integer, j As Integer, k As Integer, l As Integer Dim m As Integer, n As Integer, i1 As Integer, i2 As Integer Dim i3 As Integer, i4 As Integer, i5 As Integer, i6 As Integer Dim PWord1 As String Dim ShTag As Boolean, WinTag As Boolean Application.ScreenUpdating = False With ActiveWorkbook WinTag = .ProtectStructure Or .ProtectWindows End With ShTag = False For Each w1 In Worksheets ShTag = ShTag Or w1.ProtectContents Next w1 If Not ShTag And Not WinTag Then MsgBox MSGNOPWORDS1, vbInformation, HEADER Exit Sub End If MsgBox MSGTAKETIME, vbInformation, HEADER If Not WinTag Then MsgBox MSGNOPWORDS2, vbInformation, HEADER Else On Error Resume Next Do 'dummy do loop For i = 65 To 66: For j = 65 To 66: For k = 65 To 66 For l = 65 To 66: For m = 65 To 66: For i1 = 65 To 66 For i2 = 65 To 66: For i3 = 65 To 66: For i4 = 65 To 66 For i5 = 65 To 66: For i6 = 65 To 66: For n = 32 To 126 With ActiveWorkbook .Unprotect Chr(i) &amp; Chr(j) &amp; Chr(k) &amp; Chr(l) &amp; Chr(m) &amp; Chr(i1) &amp; Chr(i2) &amp; Chr(i3) &amp; Chr(i4) &amp; Chr(i5) &amp; Chr(i6) &amp; Chr(n) If .ProtectStructure = False And .ProtectWindows = False Then PWord1 = Chr(i) &amp; Chr(j) &amp; Chr(k) &amp; Chr(l) &amp; Chr(m) &amp; Chr(i1) &amp; Chr(i2) &amp; Chr(i3) &amp; Chr(i4) &amp; Chr(i5) &amp; Chr(i6) &amp; Chr(n) MsgBox Application.Substitute(MSGPWORDFOUND1, \"$$\", PWord1), vbInformation, HEADER Exit Do 'Bypass all for...nexts End If End With Next: Next: Next: Next: Next: Next Next: Next: Next: Next: Next: Next Loop Until True On Error GoTo 0 End If If WinTag And Not ShTag Then MsgBox MSGONLYONE, vbInformation, HEADER Exit Sub End If On Error Resume Next For Each w1 In Worksheets 'Attempt clearance with PWord1 w1.Unprotect PWord1 Next w1 On Error GoTo 0 ShTag = False For Each w1 In Worksheets 'Checks for all clear ShTag triggered to 1 if not. ShTag = ShTag Or w1.ProtectContents Next w1 If ShTag Then For Each w1 In Worksheets With w1 If .ProtectContents Then On Error Resume Next Do 'Dummy do loop For i = 65 To 66: For j = 65 To 66: For k = 65 To 66 For l = 65 To 66: For m = 65 To 66: For i1 = 65 To 66 For i2 = 65 To 66: For i3 = 65 To 66: For i4 = 65 To 66 For i5 = 65 To 66: For i6 = 65 To 66: For n = 32 To 126 .Unprotect Chr(i) &amp; Chr(j) &amp; Chr(k) &amp; Chr(l) &amp; Chr(m) &amp; Chr(i1) &amp; Chr(i2) &amp; Chr(i3) &amp; Chr(i4) &amp; Chr(i5) &amp; Chr(i6) &amp; Chr(n) If Not .ProtectContents Then PWord1 = Chr(i) &amp; Chr(j) &amp; Chr(k) &amp; Chr(l) &amp; Chr(m) &amp; Chr(i1) &amp; Chr(i2) &amp; Chr(i3) &amp; Chr(i4) &amp; Chr(i5) &amp; Chr(i6) &amp; Chr(n) MsgBox Application.Substitute(MSGPWORDFOUND2, \"$$\", PWord1), vbInformation, HEADER 'leverage finding Pword by trying on other sheets For Each w2 In Worksheets w2.Unprotect PWord1 Next w2 Exit Do 'Bypass all for...nexts End If Next: Next: Next: Next: Next: Next Next: Next: Next: Next: Next: Next Loop Until True On Error GoTo 0 End If End With Next w1 End If MsgBox ALLCLEAR &amp; AUTHORS &amp; VERSION &amp; REPBACK, vbInformation, HEADER ' End Sub","categories":[{"name":"VB","slug":"VB","permalink":"https://vbee.club/categories/VB/"}],"tags":[{"name":"VBA","slug":"VBA","permalink":"https://vbee.club/tags/VBA/"}]}]}